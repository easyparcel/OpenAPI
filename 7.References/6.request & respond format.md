# EasyParcel API Standards

This document outlines the standard formats for requests and responses when working with the EasyParcel API.

## Request Format Standards

### General Guidelines

1. All requests must be sent as HTTP POST requests
2. Content-Type header should be set to `application/json`
3. Authentication is handled via API key in the headers
4. All request payloads should be valid JSON objects
5. DateTime values should use the format: YYYY-MM-DD or YYYY-MM-DD HH:MM:SS

### Common Request Structure

Most EasyParcel API endpoints follow a consistent request format:

1. **Single Resource Requests** - Simple requests with a single parameter set:
   ```json
   {
     "parameter1": "value1",
     "parameter2": "value2"
   }
   ```

2. **Batch Requests** - Requests involving multiple items follow an array pattern:
   ```json
   {
     "resource_name": [
       { /* item 1 details */ },
       { /* item 2 details */ }
     ]
   }
   ```

### Example Request Types

#### Shipment Submission

Batch format with `shipment` array containing multiple shipment objects:

```json
{
  "shipment": [
    {
      "service_id": "EP-CS09Q",
      "collection_date": "2025-05-02",
      "weight": 2.5,
      "height": 30,
      "length": 40,
      "width": 20,
      "item": [ /* items array */ ],
      "sender": { /* sender details */ },
      "receiver": { /* receiver details */ },
      "feature": { /* feature settings */ }
    },
    // Additional shipments...
  ]
}
```

#### Quotation Request

Similar batch format with `shipment` array containing multiple quote requests:

```json
{
  "shipment": [
    {
      "sender": {
        "postcode": "10150",
        "subdivison_code": "MY-02",
        "country": "MY"
      },
      "receiver": {
        "postcode": "018916",
        "subdivison_code": "SG-04",
        "country": "SG"
      },
      "parcel_value": 50,
      "weight": 0.5,
      "width": 5,
      "length": 5,
      "height": 5
    },
    // Additional quote requests...
  ]
}
```

#### Shipment Listing Request

Simple parameter format for filtering and pagination:

```json
{
  "limit": 3,
  "before_shipment_number": "ES-2504-B944M",
  "shipment_status_code": "7",
  "date_from": "2025-04-01",
  "date_to": "2025-04-23"
}
```

---

## Response Format Standards

### General Guidelines

1. All responses are returned as JSON objects
2. Every response includes `status_code`, `message`, and `data` fields
3. Successful operations return status code 200
4. Error details are provided in both the message and data sections
5. Batch operations provide individual success/failure information for each item

### Common Response Structure

```json
{
  "status_code": 200,
  "message": "success",
  "data": [
    /* Response data objects */
  ]
}
```

### Success Response Patterns

#### Single Resource Response

```json
{
  "status_code": 200,
  "message": "success",
  "data": {
    "resource_property1": "value1",
    "resource_property2": "value2"
  }
}
```

#### Batch Operation Response

```json
{
  "status_code": 200,
  "message": "2 requests success, 1 request error.",
  "data": [
    {
      "status": "success",
      "message": "Order Processed",
      "item_id": "12345"
    },
    {
      "status": "success",
      "message": "Order Processed",
      "item_id": "12346"
    },
    {
      "status": "error",
      "message": "Invalid postal code",
      "item_id": "12347"
    }
  ]
}
```

#### Collection Response

```json
{
  "status_code": 200,
  "message": "success",
  "data": [
    { /* Item 1 */ },
    { /* Item 2 */ },
    { /* Item 3 */ }
  ]
}
```

### Error Response Patterns

#### Request Validation Error

```json
{
  "status_code": 400,
  "message": "Validation failed",
  "data": {
    "errors": [
      "The service_id field is required",
      "The collection_date field is required"
    ]
  }
}
```

#### Resource Not Found

```json
{
  "status_code": 404,
  "message": "No Order with shipment_number ES-2504-3WYYP found from this account",
  "data": []
}
```

#### Authentication Error

```json
{
  "status_code": 401,
  "message": "Invalid API key",
  "data": null
}
```

#### Partial Success in Batch Operations

```json
{
  "status_code": 200,
  "message": "1 requests success, 2 request error.",
  "data": [
    {
      "status": "success",
      "message": "Order Cancelled",
      "shipment_number": "ES-2504-WZ9VY"
    },
    {
      "status": "error",
      "message": "Shipment Already Cancelled",
      "shipment_number": "ES-2504-JUB4T"
    },
    {
      "status": "error",
      "message": "Shipment Not Found",
      "shipment_number": "ES-2504-INVALID"
    }
  ]
}
```

## Common Field Types

| Field Type | Format | Example |
|------------|--------|---------|
| Date | YYYY-MM-DD | 2025-05-02 |
| DateTime | YYYY-MM-DD HH:MM:SS | 2025-05-02 14:30:00 |
| Weight | Numeric (kg) | 2.5 |
| Dimensions | Numeric (cm) | 30 |
| Currency | ISO Currency Code | MYR |
| Country Code | ISO Country Code | MY |
| Subdivision Code | ISO 3166-2 code | MY-07 |
| Phone Code | With "+" prefix | +60 |
| Boolean | true/false | true |

## Best Practices

1. **Validate Input**: Always validate request parameters against the API documentation before submission
2. **Check Status Codes**: Always check the status_code in the response
3. **Handle Batch Responses**: For batch operations, check individual status values for each item
4. **Error Handling**: Implement proper error handling based on the error message patterns
5. **Pagination**: For list endpoints, use the provided pagination mechanisms with `limit` and `before_shipment_number`
6. **Date Ranges**: When using date ranges, ensure `date_from` is earlier than `date_to`
7. **Field Lengths**: Respect the maximum field lengths specified in the API documentation

## Notes on API Versioning

The API version is included in the URL path: `/open_api/2025-06/`

Always use the appropriate version for your implementation to ensure compatibility.
<div align="center" style="margin: 2rem 0;">

[![Back to Docs](https://img.shields.io/badge/Back_to_Docs-007ACC?style=for-the-badge&logoWidth=40)](../README.md)
[![← Previous Section](https://img.shields.io/badge/Previous_Section_←-FF7733?style=for-the-badge)](/6.Webhook/1.Guide%20to%20subscribe%20webhook.md)
[![← Previous Paragraph](https://img.shields.io/badge/Previous_Paragraph_←-FF7733?style=for-the-badge)](/7.References/5.cancel_order.md)
[![Next Paragraph →](https://img.shields.io/badge/Next_Paragraph_→-00CC88?style=for-the-badge)](/7.References/7.error%20handling.md)

</div>
